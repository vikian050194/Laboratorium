@model Laboratorium.Core.Packet

@using (Ajax.BeginForm("Console", "Console", null, new AjaxOptions
{
    InsertionMode = InsertionMode.Replace,
    HttpMethod = "POST",
    UpdateTargetId = "form",
    OnBegin = "showDialog",
    OnComplete = "hideDialog"
}, new { id = "form", @class = "form-horizontal", role = "form" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary("", new { @class = "text-danger" })
    <div>
        @Html.Hidden("errors", Model.Errors.Any())
        <ul class="nav nav-pills nav-justified" id="form-tabs" role="tablist">
            <li role="presentation" class="active">
                <a href="#script" id="script-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">Скрипт</a>
            </li>
            <li role="presentation" class="">
                <a href="#result" role="tab" id="result-tab" data-toggle="tab" aria-controls="profile" aria-expanded="false">Результат</a>
            </li>
            <li role="presentation" class="">
                <a href="#module" role="tab" id="module-tab" data-toggle="tab" aria-controls="profile" aria-expanded="false">Модули</a>
            </li>
            <li role="presentation" class="">
                <a href="#file" role="tab" id="file-tab" data-toggle="tab" aria-controls="profile" aria-expanded="false">Файл</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade active in container container-fixed" role="tabpanel" id="script" aria-labelledby="home-tab">
                @Html.TextAreaFor(m => m.Script, new {@class = "form-control"})
            </div>
            <div class="tab-pane fade container container-fixed" role="tabpanel" id="result" aria-labelledby="profile-tab">

                @if (Model.Errors.Any())
                {
                    for (var i = 0; i < Model.Errors.Count; i++)
                    {
                        <div name="Errors[@i]">@Model.Errors[i]</div>
                    }
                }
                else
                {
                    for (var i = 0; i < Model.Result.Count; i++)
                    {
                        <div name="Result[@i]">@Model.Result[i]</div>
                    }
                }
            </div>
            <div class="tab-pane fade container container-fixed" role="tabpanel" id="module" aria-labelledby="profile-tab">
                @for (var i = 0; i < Model.Modules.Count; i++)
                {
                    <div>
                        @Html.CheckBoxFor(m => m.Modules[i].IsEnadled)
                        @Html.Hidden("Modules[" + i + "].Name", Model.Modules[i].Name)
                        @Html.DisplayTextFor(m => m.Modules[i].Name)
                    </div>
                }
            </div>
            <div class="tab-pane fade container container-fixed" role="tabpanel" id="file" aria-labelledby="profile-tab">
                @for (var i = 0; i < Model.File.Count; i++)
                {
                    <div name="File[@i]">@Model.File[i]</div>
                }
            </div>
        </div>
    </div>
}